

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Verilog Handnotes 01 —— 大规模逻辑设计指导书 &mdash; Handnotes 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/my.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Verilog Handnotes 02 —— 代码规范" href="Verilog%20Handnotes%2002.html" />
    <link rel="prev" title="Verilog Handnotes" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Handnotes
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Verilog Handnotes</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Verilog Handnotes 01 —— 大规模逻辑设计指导书 </a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">笔记</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#verilog">Verilog语言编写规范</a></li>
<li class="toctree-l4"><a class="reference internal" href="#asic">可编程ASIC设计方法简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">同步电路的设计技术及规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vhdl">VHDL数字电路设计指导</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">代码可重用性</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id7">待解决(包括问题)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">Verilog语言编写规范</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">可编程ASIC设计方法简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">同步电路的设计技术及规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">VHDL数字电路设计指导</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Verilog%20Handnotes%2002.html">Verilog Handnotes 02 —— 代码规范 </a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../systemverilog/index.html">SystemVerilog Handnotes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Handnotes</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Verilog Handnotes</a> &raquo;</li>
        
      <li>Verilog Handnotes 01 —— 大规模逻辑设计指导书 </li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/verilog/Verilog Handnotes 01.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="verilog-handnotes-01">
<h1>Verilog Handnotes 01 —— 大规模逻辑设计指导书 <a class="footnote-reference brackets" href="#id12" id="id1">1</a><a class="headerlink" href="#verilog-handnotes-01" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>笔记<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="verilog">
<span id="id3"></span><h3>Verilog语言编写规范<a class="headerlink" href="#verilog" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>末尾的_n或_b表示低电平有效——p30</p></li>
<li><p>顶层模块应避免包含逻辑，仅为内部模块的互联</p></li>
<li><p>模块例化采用名称映射</p></li>
<li><p>对所有模块的输出加以寄存，使得输出的驱动强度和输入的延迟可以预测，从而使得模块的综合过程更简单</p></li>
<li><p>关键路径和非关键路径放在不同模块，利于DC优化，关键路径采取速度优化，而非关键路径采取面积优化。(DC优化一般以模块为边界进行优化，在同一模块无法实现不同综合策略)</p></li>
<li><p>MSB/LSB： data[-4:0]则MSB[-4][-3][-2][-1][0]LSB，data[0:4]则MSB[0][1][2][3][4]LSB，推荐data[4:0]则MSB[4][3][2][1][0]LSB</p></li>
<li><p>进行比较时，若位宽不同，则显式的进行扩展</p></li>
<li><p>case一般比if快，if的优先编码器仅在信号达到有先后时使用，条件赋值综合结果与case相同，但case仿真速度更快</p></li>
<li><p>内部总线不要悬空，在default状态要上拉或下拉</p></li>
<li><p>所有的`define放到一个文件中</p></li>
<li><p>在语法块的结尾做标记，// end with the name 如 // end fulladder</p></li>
<li><p>条件算式中不存在资源共享，等效的if-else则可以，如</p></li>
</ul>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">cond</span><span class="p">)</span> <span class="o">?</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">:</span> <span class="p">(</span><span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
<p>无法资源共享，而</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
<span class="k">else</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">d</span><span class="p">;</span>
</pre></div>
</div>
<p>则可以 - 使用同步复位 - testbench中避免使用绝对时间，而应该定义parameter</p>
</div>
<div class="section" id="asic">
<h3>可编程ASIC设计方法简介<a class="headerlink" href="#asic" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>可编程ASIC设计最基本的流程：
设计目标分析-&gt;功能模块划分-&gt;确定关键电路时序和模块间接口时序-&gt;具体电路设计-&gt;设计验证</p></li>
<li><p>时序是事先设计出来的，不是事后测出来的</p></li>
<li><p>通过静态时序分析进行的时序调整只是一种微调，对于大的时序调整，必须从设计本身来保证</p></li>
<li><p>接口透明，故障检查定位电路</p></li>
</ul>
</div>
<div class="section" id="id4">
<h3>同步电路的设计技术及规则<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>建立时间要求，在两级触发器之间，组合逻辑的延时(实际是第一级触发器的Clk端到第二级触发器的D端的延时)+建立时间，必须比时钟周期加时钟偏移短，(即信号必须比时钟更快到达第二级，组合逻辑延时不能太大，时钟频率不能太高)</p></li>
<li><p>保持时间要求，在两级触发器之间，组合逻辑的延时必须大于时钟偏移+保持时间(即信号到达后必须维持，或第一拍的数据必须在时钟沿到达Clk2时仍维持Tsetup)</p></li>
<li><p>在同步电路中由于时钟来自时钟PAD或时钟BUFF(全局时钟)，则时钟偏移对电路影响很小</p></li>
<li><p>单一异步控制信号的跨时钟域可以通过打拍子来实现，如果输入信号有两条以上，需要引入同步调整电路</p></li>
<li><p>上升下降沿检测，将输入信号延时一拍，之后将延时信号与原信号异或，将边沿转换为电平</p></li>
<li><p>不建议使用组合逻辑时钟和门控时钟，如不可避免，应在产生信号的模块位于顶层设计的一个独立模块中</p></li>
</ul>
</div>
<div class="section" id="vhdl">
<span id="id5"></span><h3>VHDL数字电路设计指导<a class="headerlink" href="#vhdl" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>在同步电路设计里，一个原则是：凡是分频信号，一般不作为时钟信号，而是作为控制信号</p></li>
<li><p>处理速度与面积问题的一个原则是：向关键路径(部分)要时间(减少逻辑级数)，向非关键路径(部分)要面积(尽量共享已有逻辑)</p></li>
<li><p>对于比较器，应当尽量根据电路特点，抽取出“固定部分”，减少变化部分</p></li>
<li><p>减少关键路径延时的常用方法，给最迟到达的信号最高优先级，这样能减少关键路径的级数</p></li>
<li><p>对于循环语句，尽量将运算符放到循环外，循环体用于输入信号选择，这样可以复用运算模块</p></li>
<li><p>one-hot编码可以降低状态转移电路的实现逻辑的复杂度，但是由于引入了更大的状态空间，其非法(未定义)状态检测电路需要更多的逻辑</p></li>
</ul>
</div>
<div class="section" id="id6">
<h3>代码可重用性<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>建议使用以下端口声明次序：</p>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span>
    <span class="n">clocks</span>
    <span class="n">resets</span>
    <span class="n">enables</span>
    <span class="n">other</span> <span class="n">control</span> <span class="n">signals</span>
    <span class="n">data</span> <span class="k">and</span> <span class="n">address</span> <span class="n">lines</span>
<span class="n">outputs</span>
    <span class="n">clocks</span>
    <span class="n">resets</span>
    <span class="n">enables</span>
    <span class="n">other</span> <span class="n">control</span> <span class="n">signals</span>
    <span class="n">data</span>
</pre></div>
</div>
<ul class="simple">
<li><p>在输入输出端口之间加一个空行以提高可读性</p></li>
<li><p>使用函数代替重用代码，函数要加注释</p></li>
<li><p>在仿真时，数组比for loop快得多，尽量使用数组用向量操作而非for loop</p></li>
<li><p>使用parameter代替固定位宽等</p></li>
<li><p>避免使用多时钟沿，在不可避免时，尽量将上升沿和下降沿触发的寄存器放到不同模块</p></li>
<li><p>避免使用手动例化的时钟buffer，时钟buffer一般时在综合后物理设计时插入</p></li>
<li><p>避免内部产生复位信号，确保所有寄存器只被简单复位信号控制，通常模块内所有寄存器应在同一时间内被复位</p></li>
<li><p>避免使用任何的latch</p></li>
<li><p>避免使用组合反馈电路</p></li>
<li><p>定义完整的敏感列表</p></li>
</ul>
</div>
</div>
<div class="section" id="id7">
<h2>待解决(包括问题)<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id8">
<h3>Verilog语言编写规范<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p><span class="strike">“名字一般首字母大写，其余小写(但parameter，integer定义的数值名可全部用大写)，两个词之间要用下划线连接”
“自己定义的常数、类型等用大写标识” ——p30
——习惯Linux命名习惯，首字母是否一定要大写</span></p></li>
<li><p><input checked=""  type="checkbox"> 文件头描述</p></li>
<li><p><input checked=""  type="checkbox"> 每行应限制在80(72)个字符</p></li>
<li><p><input checked=""  type="checkbox"> 输出驱动的强度都等于平均的触发器的驱动强度</p></li>
<li><p><input checked=""  type="checkbox"> function与task：function可以理解为一个组合逻辑块(一个或多个表达式)的抽象，其必须有一个或以上的input，其返回值便是逻辑块的输出。故function内部不应当含有非阻塞或过程连续赋值语句(procedual continuous assignment，包括 <strong>assign/deassign和force/release, 任何的时间控制语句，即任何用＃、&#64;、或wait来标识的语句</strong> );task则是一个过程块的抽象，所以task可以包含组合逻辑(function)或时序逻辑</p></li>
</ol>
<div class="highlight-verilog notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> <span class="p">[</span><span class="nl">width0:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">function_name</span> <span class="p">(</span><span class="k">input</span> <span class="p">[</span><span class="nl">width1:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">input_name</span><span class="p">);</span>
<span class="k">begin</span>
    <span class="c1">// code</span>
<span class="k">end</span>
<span class="k">endfunction</span>
<span class="c1">// 或</span>
<span class="k">function</span> <span class="p">[</span><span class="nl">width0:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">function_name</span><span class="p">;</span>
<span class="k">input</span> <span class="p">[</span><span class="nl">width1:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">input_name</span><span class="p">;</span>
<span class="k">begin</span>
    <span class="c1">// code</span>
<span class="k">end</span>
<span class="k">endfunction</span>

<span class="k">task</span> <span class="n">task_name</span> <span class="p">(</span><span class="k">input</span> <span class="p">[</span><span class="nl">width0:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">,</span> <span class="k">input</span> <span class="p">[</span><span class="nl">width1:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">b</span><span class="p">,</span> <span class="k">output</span> <span class="p">[</span><span class="nl">width2:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">c</span><span class="p">);</span>
<span class="k">begin</span>
    <span class="c1">// code</span>
<span class="k">end</span>
<span class="k">endtask</span>
<span class="c1">// 或</span>
<span class="k">task</span> <span class="n">task_name</span><span class="p">;</span>
<span class="k">input</span> <span class="p">[</span><span class="nl">width0:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">a</span><span class="p">;</span>
<span class="k">input</span> <span class="p">[</span><span class="nl">width1:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">b</span><span class="p">;</span>
<span class="k">output</span> <span class="p">[</span><span class="nl">width2:</span> <span class="mh">0</span><span class="p">]</span> <span class="n">c</span><span class="p">;</span>
<span class="k">begin</span>
    <span class="c1">// code</span>
<span class="k">end</span>
<span class="k">endtask</span>
</pre></div>
</div>
<ol class="arabic simple" start="6">
<li><p><input type="checkbox"> 函数与任务的调用均为静态调用</p></li>
<li><p><span class="strike">对于任何reg赋值，用非阻塞赋值代替阻塞赋值，reg的非阻塞赋值要加单位延迟，但异步复位可加可不加</span></p></li>
</ol>
</div>
<div class="section" id="id9">
<h3>可编程ASIC设计方法简介<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p><input type="checkbox"> 在进行静态时序分析时，分析工具需要设计者给出“合法路径”，由分析工具自动的完成时序分析，如路径延时等信息。需要设计者对所有路径提出具体的时序要求如I/O管脚之间时序要求</p></li>
</ol>
</div>
<div class="section" id="id10">
<h3>同步电路的设计技术及规则<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><p><input checked=""  type="checkbox"> 在FPGA设计中，推荐所有的输入、输出信号均应通过寄存器寄存，寄存器接口当作异步接口考虑</p></li>
</ol>
</div>
<div class="section" id="id11">
<h3>VHDL数字电路设计指导<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li><dl class="simple">
<dt><input checked=""  type="checkbox"> Barrel Shifter</dt><dd><p>具有n个数据输入和n个数据输出，以及指定如何移动数据的控制输入，指定移位方向、移位类型(循环、算术还是逻辑移位)及移动的位数</p>
</dd>
</dl>
</li>
</ol>
<dl class="footnote brackets">
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>读书笔记 (大规模逻辑设计指导书)2020-12-11</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Verilog%20Handnotes%2002.html" class="btn btn-neutral float-right" title="Verilog Handnotes 02 —— 代码规范" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Verilog Handnotes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, meuhor

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>